extends layout

block content
    link(rel="stylesheet", href="/stylesheets/dataTables.min.css")
    .row
        h5.green-text.left.tituloTop= title
    section(class="container")
        .row.comprar
            ul.collapsible
                li
                    .collapsible-header
                        i.material-icons filter_drama
                        | Categoria 1
                    .collapsible-body
                        //- .col.s12
                        //-     .input-field.col.s12
                        //-         i.material-icons.prefix search
                        //-         input#searchProduto.autocomplete(type='text')
                        //-         label(for='searchProduto') Pesquisar Produto

                        table.highlight.tableProduto#minhaTabela(class="display" style="width:100%")
                            thead
                                tr
                                th Foto
                                th Produto
                                th Preço
                                th.add ADD
                            tbody#myTable
                                tr
                                    td 
                                        img.responsive-img(src='/images/produtos/bebidas/brahma-latao.jpg' width="100")
                                    td Leite Condensado Italac
                                    td.green-text 
                                        p.green-text R$ 3,55
                                        p.red-text R$ 3,85
                                    td.add 
                                        button.btnADDComprar.qntdBM.red.white-text -
                                        button.btnADDComprar.qntdB.green.white-text +
                                        p.qntdP.center 0
                                        input.menorPreco(value="3.55" type="hidden")
                                        input.maiorPreco(value="3.85" type="hidden")
                                        input.idProduto(value="idProduto" type="hidden")
                                        input.addValue(type="hidden")
                                tr
                                    td 
                                        img.responsive-img(src='/images/produtos/bebidas/brahma-latao.jpg' width="100")
                                    td Leite Condensado Italac
                                    td.green-text 
                                        p.green-text R$ 3,55
                                        p.red-text R$ 3,85
                                    td.add 
                                        button.btnADDComprar.qntdBM.red.white-text -
                                        button.btnADDComprar.qntdB.green.white-text +
                                        p.qntdP.center 0
                                        input.menorPreco(value="3.55" type="hidden")
                                        input.maiorPreco(value="3.85" type="hidden")
                                        input.idProduto(value="idProduto" type="hidden")
                                        input.addValue(type="hidden")
                                tr
                                    td 
                                        img.responsive-img(src='/images/produtos/bebidas/brahma-latao.jpg' width="100")
                                    td Leite Condensado Italac
                                    td.green-text 
                                        p.green-text R$ 3,55
                                        p.red-text R$ 3,85
                                    td.add 
                                        button.btnADDComprar.qntdBM.red.white-text -
                                        button.btnADDComprar.qntdB.green.white-text +
                                        p.qntdP.center 0
                                        input.menorPreco(value="3.55" type="hidden")
                                        input.maiorPreco(value="3.85" type="hidden")
                                        input.idProduto(value="idProduto" type="hidden")
                                        input.addValue(type="hidden")
                                

                li
                    .collapsible-header
                        i.material-icons place
                        | Categoria 2
                    .collapsible-body
                        span Lorem ipsum dolor sit amet.
                li
                    .collapsible-header
                        i.material-icons whatshot
                        | Categoria 3
                    .collapsible-body
                        span Lorem ipsum dolor sit amet.


    .white
        section(class="container")
            .row
                .col.s12.right-text
                    button.green.finalizar(class="waves-effect waves-light btn right" style="margin-top: 25px") 
                        i.material-icons.right shopping_cart
                        | Finalizar
                    p.green-text Carrinho: R$ 
                        span#carrinhoMenor 0.0
                    p.red-text Carrinho: R$ 
                        span#carrinhoMaior 0.0
            .center
                .preloader-wrapper.loaderSupermercados
                    .spinner-layer.spinner-red-only
                        .circle-clipper.left
                            .circle
                        .gap-patch
                            .circle
                        .circle-clipper.right
                            .circle
            .row.supermercadosFim.supermercadoAddClass
                .col.s12.m6
                    .card
                        .card-image
                            img(src='/images/supermercado/bonifacio.jpg')
                            span.card-title 
                        .card-content
                            p valor: 
                                span.green-text.finalizarCompraB
                            p.green-text VOCÊ É CLIENTE VIP DESSE LOCAL
                            p(style="font-size: 11px; color: #ccc; margin-top: 10px;") *Sendo VIP, você tem o direito de pedir a compra diretamente do app
                        .card-action
                            .col.s6.center
                                a(class="waves-effect waves-light btn-small green") Entrega
                            .col.s6.center
                                a(class="waves-effect waves-light btn-small" href="/lista") Salvar
                .col.s12.m6
                    .card
                        .card-image
                            img(src='/images/supermercado/qualquer.jpg')
                            span.card-title 
                        .card-content
                            p valor: 
                                span.red-text.finalizarCompraC
                            //- p.green-text VOCÊ É CLIENTE VIP DESSE LOCAL
                            p(style="font-size: 11px; color: #ccc; margin-top: 50px;") *Sendo VIP, você tem o direito de pedir a compra diretamente do app
                        .card-action
                            .col.s6.center
                                a(class="waves-effect waves-light btn-small green") Entrega
                            .col.s6.center
                                a(class="waves-effect waves-light btn-small" href="/lista") Salvar




block rodape
    script.
        $(document).ready(function(){
            $('.collapsible').collapsible();

            $( ".qntdB" ).click(function() {
                var atualizaX = $(this).next().text();
                var atualizaX = atualizaX*1;
                $(this).next().text(atualizaX+1);
                var x = $(this).next().text();
                $(this).next().next().next().next().next($( "input" )).val(x);
                var menorPreco = $(this).next().next().val();
                var maiorPreco = $(this).next().next().next().val();
                var menorPreco = parseFloat(menorPreco);
                var maiorPreco = parseFloat(maiorPreco);
                var carrinhoMenor = $("#carrinhoMenor").text();
                var carrinhoMaior = $("#carrinhoMaior").text();
                var carrinhoMenor = parseFloat(carrinhoMenor);
                var carrinhoMaior = parseFloat(carrinhoMaior);
                var carrinhoMenor = parseFloat((carrinhoMenor+menorPreco).toFixed(2));
                var carrinhoMaior = parseFloat((carrinhoMaior+maiorPreco).toFixed(2));
                $("#carrinhoMenor").html(carrinhoMenor);                
                $("#carrinhoMaior").html(carrinhoMaior);
            });

            $( ".qntdBM" ).click(function() {
                var atualizaX = $(this).next().next().text();
                var atualizaX = atualizaX*1;
                if(atualizaX == 0){
                    alert("Você ainda não adicionou esse item ao seu carrinho")
                } else {
                    $(this).next().next().text(atualizaX-1);
                    var x = $(this).next().next().text();
                    $(this).next().next().next().next().next().next($( "input" )).val(x);
                    var menorPreco = $(this).next().next().next().val();
                    var maiorPreco = $(this).next().next().next().next().val();
                    var menorPreco = parseFloat(menorPreco);
                    var maiorPreco = parseFloat(maiorPreco);
                    var carrinhoMenor = $("#carrinhoMenor").text();
                    var carrinhoMaior = $("#carrinhoMaior").text();
                    var carrinhoMenor = parseFloat(carrinhoMenor);
                    var carrinhoMaior = parseFloat(carrinhoMaior);
                    var carrinhoMenor = parseFloat(carrinhoMenor.toFixed(2));
                    var carrinhoMaior = parseFloat(carrinhoMaior.toFixed(2));
                    var carrinhoMenor = parseFloat((carrinhoMenor-menorPreco).toFixed(2));
                    var carrinhoMaior = parseFloat((carrinhoMaior-maiorPreco).toFixed(2));
                    $("#carrinhoMenor").html(carrinhoMenor );                
                    $("#carrinhoMaior").html(carrinhoMaior ); 
                }
            });

            $( ".finalizar" ).click(function() {
                var bonifacio = $("#carrinhoMenor").text();
                if(bonifacio != 0){
                    $('.collapsible').collapsible('close');
                    //- alert($("#carrinhoMaior").text());
                    $(".finalizarCompraB").text("R$ "+ bonifacio);
                    var qualquer = $("#carrinhoMaior").text();
                    $(".finalizarCompraC").text("R$ "+ qualquer);
                    $('.supermercadoAddClass').addClass('supermercadosFim');
                    $('.loaderSupermercados').addClass('active');
                    setTimeout(function(){ 
                        $('.loaderSupermercados').removeClass('active');
                        $('.supermercadosFim').removeClass('supermercadosFim');
                    }, 1000);
                }
                
            });

            $("#searchProduto").on("keyup", function() {
                var value = $(this).val().toLowerCase();
                $("#myTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });

            $('#minhaTabela').DataTable({
                "pageLength": 4,
                "language": {
                    "lengthMenu": "Suerp IT - Busca",
                    "search": "Buscar Produto",
                    "zeroRecords": "Nada encontrado",
                    "info": "Mostrando página _PAGE_ de _PAGES_",
                    "infoEmpty": "Nenhum registro disponível",
                    "infoFiltered": "(filtrado de _MAX_ registros no total)"
                }
            });

            
        });